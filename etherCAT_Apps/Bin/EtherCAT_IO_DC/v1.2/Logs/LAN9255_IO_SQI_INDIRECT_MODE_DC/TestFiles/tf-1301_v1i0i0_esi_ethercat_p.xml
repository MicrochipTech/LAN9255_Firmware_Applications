<?xml version="1.0" encoding="UTF-8" standalone="yes"?><EtherCATTest Name="TF-1301 ESI EtherCAT P" SchemaVersion="1.0.31" TestVersion="1.0.0" TestId="4865" xsi:noNamespaceSchemaLocation="EtherCATTest.xsd" Url="http://www.ethercat.org/en/conformance.html" TestVendorId="1" RealeaseState="Released" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<Comment>This test file includes test cases to ensure the conformance of EtherCAT P devices to the ETG 2000 and ETG 1030 specification. Non EtherCAT P devices are not subject of this test.

ESI					EtherCAT Slave Information file
DuT					Device under Test
EtherCAT P device			A DuT is identified as EtherCAT P device if the /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp element is available
PD					Powered Device (All EtherCAT P devices powered over EtherCAT P. Port 0 is power source for the device and, if available, outgoing EtherCAT-P-Ports.)
PS					Power Sourcing Device (EtherCAT P Devices sourcing the EtherCAT P Segments are equipped with an external 2x24 volt supply. The device and the OUT-Ports are powered by external voltage)</Comment>
	<History>
		<HistoryEntry Editor="O.H." TestVersion="0.0.0" Date="2016-03-30">New test file created</HistoryEntry>
		<HistoryEntry Editor="B.L." TestVersion="0.9.9" Date="2018-09-14">Add output IDs and update Schema version to 1.0.31</HistoryEntry>
	</History>
	<TestVariables>
		<TestVariable>
			<Name>EsiFilename</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
		</TestVariable>
		<TestVariable>
			<Name>EsiDevicePosition</Name>
			<Type>Int32</Type>
			<DefaultValue>0</DefaultValue>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Us:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Us:MinVoltage</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Us:Current</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Us:Current:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Up:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Up:MinVoltage</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Up:Current</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:Device:Up:Current:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:PowerSupply</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:PowerSupply:Us</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:PowerSupply:Us:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:PowerSupply:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Electrical:EtherCATp:PowerSupply:Up:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:Connector</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:Connector:VendorId</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Us</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Us:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Us:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Us:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Up:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Up:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port0:EtherCATp:Up:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:Connector</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:Connector:VendorId</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Us</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Us:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Us:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Us:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Up:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Up:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port1:EtherCATp:Up:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:Connector</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:Connector:VendorId</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Us</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Us:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Us:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Us:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Up:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Up:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port2:EtherCATp:Up:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:Type</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:Connector</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:Connector:VendorId</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Us</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Us:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Us:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Us:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Up</Name>
			<Type>String</Type>
			<DefaultValue>null</DefaultValue>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Up:PowerSupply</Name>
			<Type>Bool</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Up:MaxCurrent</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
		<TestVariable>
			<Name>Port3:EtherCATp:Up:Resistance</Name>
			<Type>Real32</Type>
			<Comment>Esi xml value</Comment>
		</TestVariable>
	</TestVariables>
	<Variables>
		<Variable>
			<Name>boolVar</Name>
			<Type>Bool</Type>
		</Variable>
		<Variable>
			<Name>boolIsEthercatP</Name>
			<Type>Bool</Type>
		</Variable>
		<Variable>
			<Name>intIndex</Name>
			<Type>Int32</Type>
		</Variable>
		<Variable>
			<Name>ethercatpPortCount</Name>
			<Type>Int32</Type>
		</Variable>
	</Variables>
	<EcatCmdGrps>
	</EcatCmdGrps>
	<IncludedTestFunctions>
		<FileName>EcBaseFunctions_V1i0i0.xml</FileName>
	</IncludedTestFunctions>
	<TestFunctions>
		<TestFunction Name="InitEsiValues" FunctionId="101"><?MAX_OUTPUT_ID 4?>
			<TestStep Name="SkipIfAlreadyInitialized">
				<Description Id="0" Param0="DeviceDescr.FileName" Param1="EsiFilename" Param2="DeviceDescr.Position" Param3="EsiDevicePosition" Level="Verbose">ESI: '{0}'/'{1}' Pos: {2}/{3}</Description>
				<Compare>
					<Equal>
						<Value1>DeviceDescr.FileName</Value1>
						<Value2>null</Value2>
						<RaiseError Id="1">No ESI file found!</RaiseError>
					</Equal>
				</Compare>
				<Compare>
					<Equal>
						<Value1>DeviceDescr.Position</Value1>
						<Value2>0</Value2>
						<RaiseError Id="2">Invalid device position in ESI file!</RaiseError>
					</Equal>
				</Compare>
				<Compare>
					<NotEqual>
						<Value1>DeviceDescr.FileName</Value1>
						<Value2>EsiFilename</Value2>
						<GotoStep>GetElectricalEtherCATp</GotoStep>
					</NotEqual>
				</Compare>
				<Compare>
					<Equal>
						<Value1>DeviceDescr.Position</Value1>
						<Value2>EsiDevicePosition</Value2>
						<Return Id="3"></Return>
					</Equal>
				</Compare>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATp">
				<Description Id="4">Reinit ESI values</Description>
				<GetXmlValue ReturnValue="Electrical:EtherCATp" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUsPowerSupply">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Us:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Us/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUsMinVoltage">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Us:MinVoltage" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Us/MinVoltage</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUsCurrent">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Us:Current" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Us/Current/text()</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUsCurrentType">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Us:Current:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Us/Current/@Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUpPowerSupply">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Up:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Up/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUp">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUpMinVoltage">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Up:MinVoltage" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Up/MinVoltage</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUpCurrent">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Up:Current" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Up/Current/text()</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpDeviceUpCurrentType">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:Device:Up:Current:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/Device/Up/Current/@Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpPowerSupply">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpPowerSupplyUs">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:PowerSupply:Us" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/PowerSupply/Us</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpPowerSupplyUsMaxCurrent">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:PowerSupply:Us:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/PowerSupply/Us/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpPowerSupplyUp">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:PowerSupply:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/PowerSupply/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetElectricalEtherCATpPowerSupplyUpMaxCurrent">
				<GetXmlValue ReturnValue="Electrical:EtherCATp:PowerSupply:Up:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Electrical/EtherCATp/PowerSupply/Up/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATp">
				<GetXmlValue ReturnValue="Port0:EtherCATp" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0Type">
				<GetXmlValue ReturnValue="Port0:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0Connector">
				<GetXmlValue ReturnValue="Port0:Connector" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/Connector</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0ConnectorVendorId">
				<GetXmlValue ReturnValue="Port0:Connector:VendorId" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/Connector/@VendorId</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUs">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Us" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Us</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUsPowerSupply">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Us:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Us/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUsMaxCurrent">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Us:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Us/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUsResistance">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Us:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Us/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUp">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUpPowerSupply">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Up:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Up/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUpMaxCurrent">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Up:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Up/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort0EtherCATpUpResistance">
				<GetXmlValue ReturnValue="Port0:EtherCATp:Up:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=1]/EtherCATp/Up/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1Type">
				<GetXmlValue ReturnValue="Port1:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATp">
				<GetXmlValue ReturnValue="Port1:EtherCATp" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1Connector">
				<GetXmlValue ReturnValue="Port1:Connector" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/Connector</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1ConnectorVendorId">
				<GetXmlValue ReturnValue="Port1:Connector:VendorId" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/Connector/@VendorId</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUs">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Us" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Us</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUsPowerSupply">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Us:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Us/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUsMaxCurrent">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Us:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Us/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUsResistance">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Us:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Us/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUp">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUpPowerSupply">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Up:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Up/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUpMaxCurrent">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Up:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Up/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort1EtherCATpUpResistance">
				<GetXmlValue ReturnValue="Port1:EtherCATp:Up:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=2]/EtherCATp/Up/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2Type">
				<GetXmlValue ReturnValue="Port2:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATp">
				<GetXmlValue ReturnValue="Port2:EtherCATp" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2Connector">
				<GetXmlValue ReturnValue="Port2:Connector" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/Connector</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2ConnectorVendorId">
				<GetXmlValue ReturnValue="Port2:Connector:VendorId" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/Connector/@VendorId</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUs">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Us" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Us</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUsPowerSupply">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Us:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Us/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUsMaxCurrent">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Us:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Us/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUsResistance">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Us:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Us/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUp">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUpPowerSupply">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Up:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Up/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUpMaxCurrent">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Up:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Up/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort2EtherCATpUpResistance">
				<GetXmlValue ReturnValue="Port2:EtherCATp:Up:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=3]/EtherCATp/Up/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3Type">
				<GetXmlValue ReturnValue="Port3:Type" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/Type</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATp">
				<GetXmlValue ReturnValue="Port3:EtherCATp" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3Connector">
				<GetXmlValue ReturnValue="Port3:Connector" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/Connector</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3ConnectorVendorId">
				<GetXmlValue ReturnValue="Port3:Connector:VendorId" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/Connector/@VendorId</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUs">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Us" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Us</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUsPowerSupply">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Us:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Us/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUsMaxCurrent">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Us:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Us/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUsResistance">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Us:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Us/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUp">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Up" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Up</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUpPowerSupply">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Up:PowerSupply" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Up/PowerSupply</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUpMaxCurrent">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Up:MaxCurrent" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Up/MaxCurrent</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="GetPort3EtherCATpUpResistance">
				<GetXmlValue ReturnValue="Port3:EtherCATp:Up:Resistance" Markup="false" FileName="EmptyString">
					<XPath>Info/Port[position()=4]/EtherCATp/Up/Resistance</XPath>
				</GetXmlValue>
			</TestStep>
			<TestStep Name="SetFilename">
				<SetVariable Target="EsiFilename">DeviceDescr.FileName</SetVariable>
			</TestStep>
			<TestStep Name="SetDevicePosition">
				<SetVariable Target="EsiDevicePosition">DeviceDescr.Position</SetVariable>
			</TestStep>
		</TestFunction>
		<TestFunction Name="IsRefreshingDevice" FunctionId="201"><?MAX_OUTPUT_ID 6?>
			<OutParameter>
				<Name>IsRefreshingDevice.ErrorMessage</Name>
				<Type>String</Type>
			</OutParameter>
			<TestStep Name="InitErrorMessage">
				<SetVariable Target="IsRefreshingDevice.ErrorMessage">EmptyString</SetVariable>
			</TestStep>
			<TestStep Name="IsInfoAvailable">
				<Compare>
					<Equal>
						<Value1>DeviceDescr.Info </Value1>
						<Value2>false</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info element is not defined</SetVariable>
					</Equal>
				</Compare>
				<Compare>
					<Equal>
						<Value1>DeviceDescr.Info </Value1>
						<Value2>false</Value2>
						<Return Id="0"></Return>
					</Equal>
				</Compare>
			</TestStep>
			<TestStep Name="IsPowerSupply">
				<Compare>
					<Equal>
						<Value1>Electrical:EtherCATp:PowerSupply</Value1>
						<Value2>null</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info:EtherCATp:PowerSupply element is not defined</SetVariable>
					</Equal>
				</Compare>
				<Compare>
					<Equal>
						<Value1>Electrical:EtherCATp:PowerSupply</Value1>
						<Value2>null</Value2>
						<Return Id="1"></Return>
					</Equal>
				</Compare>
			</TestStep>
			<TestStep Name="CheckPortCout">
				<Compare>
					<Lower>
						<Value1>DeviceDescr.Info.Port.Count</Value1>
						<Value2>2</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info.Port element count is lower 2</SetVariable>
					</Lower>
				</Compare>
				<Compare>
					<Lower>
						<Value1>DeviceDescr.Info.Port.Count</Value1>
						<Value2>2</Value2>
						<Return Id="2"></Return>
					</Lower>
				</Compare>
			</TestStep>
			<TestStep Name="CheckPort0IsEtherCAT_P">
				<Compare>
					<Equal>
						<Value1>Port0:EtherCATp</Value1>
						<Value2>null</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info.Port[0]EtherCATp element is not defined</SetVariable>
					</Equal>
				</Compare>
				<Compare>
					<Equal>
						<Value1>Port0:EtherCATp</Value1>
						<Value2>null</Value2>
						<Return Id="3"></Return>
					</Equal>
				</Compare>
			</TestStep>
			<TestStep Name="CheckPort0IsEtherCATpUs">
				<Compare>
					<NotEqual>
						<Value1>Port0:EtherCATp:Us</Value1>
						<Value2>null</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info.Port[0]EtherCATp:Us element is defined</SetVariable>
					</NotEqual>
				</Compare>
				<Compare>
					<NotEqual>
						<Value1>Port0:EtherCATp:Us</Value1>
						<Value2>null</Value2>
						<Return Id="4"></Return>
					</NotEqual>
				</Compare>
			</TestStep>
			<TestStep Name="CheckPort0IsEtherCATpUp">
				<Compare>
					<NotEqual>
						<Value1>Port0:EtherCATp:Up</Value1>
						<Value2>null</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because the ESI Device:Info.Port[0]EtherCATp:Up element is defined</SetVariable>
					</NotEqual>
				</Compare>
				<Compare>
					<NotEqual>
						<Value1>Port0:EtherCATp:Up</Value1>
						<Value2>null</Value2>
						<Return Id="5"></Return>
					</NotEqual>
				</Compare>
			</TestStep>
			<TestStep Name="CheckAtLeastOneOutportisEtherCATp">
				<Compare>
					<Equal>
						<Value1>Port1:EtherCATp NOTEQUAL null OR Port2:EtherCATp NOTEQUAL null OR Port3:EtherCATp NOTEQUAL null</Value1>
						<Value2>null</Value2>
						<SetVariable Target="IsRefreshingDevice.ErrorMessage">Device is not categorized as refreshing device because no out-port is defined as EtherCATp</SetVariable>
					</Equal>
				</Compare>
				<Compare>
					<Equal>
						<Value1>Port1:EtherCATp NOTEQUAL null OR Port2:EtherCATp NOTEQUAL null OR Port3:EtherCATp NOTEQUAL null</Value1>
						<Value2>null</Value2>
						<Return Id="6"></Return>
					</Equal>
				</Compare>
			</TestStep>
		</TestFunction>
	</TestFunctions>
	<TestGroups>
		<TestGroup Name="General ESI plausibility all device types" GroupId="1">
			<Comment>Checks the plausibility of the EtherCAT P specific extensions of all EtherCAT P device types.</Comment>
			<TestCase Name="Port Availability" CaseId="1"><?MAX_OUTPUT_ID 15?>
				<Description>
					<Purpose>EtherCAT P devices shall provide at least one port which is configured as EtherCAT P.</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>The test case iterates through the ESI-Info/Port descriptions and checks for EtherCAT P elements</Action>
					<PostCondition>-The test case will be skipped for non EtherCAT P devices
-Test case succeeds if at least one EtherCAT P Port is found. Otherwise an error is thrown.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Description Id="3">Check if at least one port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0">
					<Description Id="5">Check description of port 0</Description>
					<Compare>
						<NotEqual>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<WriteLine Id="6" Level="Output">Port0 configured as EtherCAT P</WriteLine>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1">
					<Description Id="7">Check description of port 1</Description>
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<WriteLine Id="8" Level="Output">Port1 configured as EtherCAT P</WriteLine>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2">
					<Description Id="9">Check description of port 2</Description>
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<WriteLine Id="10" Level="Output">Port2 configured as EtherCAT P</WriteLine>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3">
					<Description Id="11">Check description of port 3</Description>
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<WriteLine Id="12" Level="Output">Port3 configured as EtherCAT P</WriteLine>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkEthercatPInfoPortCount">
					<Description Id="13">Check if at least one EtherCAT P port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<RaiseError Id="14">No EtherCAT P port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="15" Level="Success" Param0="ethercatpPortCount">{0} EtherCAT P port descriptions found</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Port Connectors" CaseId="2"><?MAX_OUTPUT_ID 18?>
				<Description>
					<Purpose>Each EtherCAT P port shall have a connector description. </Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>Test case iterates through the ESI-Info/Port descriptions and checks for a valid connector and connector-vendor Id</Action>
					<PostCondition>-The test case will be skipped for non EtherCAT P devices
-Test case fails if a EtherCAT P port is not configured as M8P connector with the connector-vendor Id 1.
-Test case fails if a non EtherCAT P port is configured as M8P connector.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="3">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp EQUAL null AND Port0:Connector EQUAL "M8P"</Value1>
							<Value2>true</Value2>
							<RaiseError Id="4">Port0: Non EtherCATp ports shall not configure the M8P-Connector</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort1</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port0IncrementCount">
					<SetVariable Target="ethercatpPortCount">1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort0Connector">
					<Compare>
						<NotEqual>
							<Value1>Port0:Connector</Value1>
							<Value2>"M8P"</Value2>
							<RaiseError Id="5" Param0="Port0:Connector">Invalid Connector value '{0}' for port 0. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port0:Connector:VendorId</Value1>
							<Value2>"1"</Value2>
							<RaiseError Id="6" Param0="Port0:Connector:VendorId">Invalid Connector VendorId value '{0}' for port 0. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp EQUAL null AND Port1:Connector EQUAL "M8P"</Value1>
							<Value2>true</Value2>
							<RaiseError Id="7">Port1: Non EtherCATp ports shall not configure the M8P-Connector</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port1IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort1Connector">
					<Compare>
						<NotEqual>
							<Value1>Port1:Connector</Value1>
							<Value2>"M8P"</Value2>
							<RaiseError Id="8" Param0="Port1:Connector">Invalid Connector value '{0}' for port 1. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port1:Connector:VendorId</Value1>
							<Value2>"1"</Value2>
							<RaiseError Id="9" Param0="Port1:Connector:VendorId">Invalid Connector VendorId value '{0}' for port 1. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp EQUAL null AND Port2:Connector EQUAL "M8P"</Value1>
							<Value2>true</Value2>
							<RaiseError Id="10">Port2: Non EtherCATp ports shall not configure the M8P-Connector</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port2IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort2Connector">
					<Compare>
						<NotEqual>
							<Value1>Port2:Connector</Value1>
							<Value2>"M8P"</Value2>
							<RaiseError Id="11" Param0="Port2:Connector">Invalid Connector value '{0}' for port 2. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port2:Connector:VendorId</Value1>
							<Value2>"1"</Value2>
							<RaiseError Id="12" Param0="Port2:Connector:VendorId">Invalid Connector VendorId value '{0}' for port 2. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp EQUAL null AND Port3:Connector EQUAL "M8P"</Value1>
							<Value2>true</Value2>
							<RaiseError Id="13">Port0: Non EtherCATp ports shall not configure the M8P-Connector</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkEthercatPInfoPortCount</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port3IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort3Connector">
					<Compare>
						<NotEqual>
							<Value1>Port3:Connector</Value1>
							<Value2>"M8P"</Value2>
							<RaiseError Id="14" Param0="Port3:Connector">Invalid Connector value '{0}' for port 3. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port3:Connector:VendorId</Value1>
							<Value2>"1"</Value2>
							<RaiseError Id="15" Param0="Port3:Connector:VendorId">Invalid Connector VendorId value '{0}' for port 3. Expected: 'M8P'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkEthercatPInfoPortCount">
					<Description Id="16">Check if at least one EtherCAT P port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<RaiseError Id="17">No EtherCAT P port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="18" Level="Success" Param0="ethercatpPortCount">{0} EtherCAT P port descriptions with correct connector values found</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Port Physics" CaseId="3"><?MAX_OUTPUT_ID 14?>
				<Description>
					<Purpose>A EtherCAT P port shall be configured as a 'Y' at the corresponding Physics attribute. (Xpath: /EtherCATInfo/Descriptions/Devices/Device[n]/@Physics)</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>The test case iterates through the  EtherCAT P-ESI-Info/Port descriptions and compares the corresponding Physics letter</Action>
					<PostCondition>-The test case will be skipped for non EtherCAT P devices
-The test case succeeds if all EtherCAT P ports are configured as 'Y' at the Physics attribute.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="3">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort1</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPhysicsLengthPort0">
					<Compare>
						<Lower>
							<Value1>DeviceDescr.Physics.Count</Value1>
							<Value2>1</Value2>
							<RaiseError Id="4">Invalid value or length of EtherCATInfo/Descriptions/Devices/Device/@Physics attribute.</RaiseError>
						</Lower>
					</Compare>
				</TestStep>
				<TestStep Name="Port0IncrementCount">
					<SetVariable Target="ethercatpPortCount">1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort0Connector">
					<Compare>
						<NotEqual>
							<Value1>DeviceDescr.Physics[0]</Value1>
							<Value2>"Y"</Value2>
							<RaiseError Id="5" Param0="DeviceDescr.Physics[0]">Invalid Physics value '{0}' for port 0. Expected: 'Y'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPhysicsLengthPort1">
					<Compare>
						<Lower>
							<Value1>DeviceDescr.Physics.Count</Value1>
							<Value2>2</Value2>
							<RaiseError Id="6">Invalid value or length of EtherCATInfo/Descriptions/Devices/Device/@Physics attribute.</RaiseError>
						</Lower>
					</Compare>
				</TestStep>
				<TestStep Name="Port1IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort1Connector">
					<Compare>
						<NotEqual>
							<Value1>DeviceDescr.Physics[1]</Value1>
							<Value2>"Y"</Value2>
							<RaiseError Id="7" Param0="DeviceDescr.Physics[1]">IInvalid Physics value '{0}' for port 1. Expected: 'Y'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPhysicsLengthPort2">
					<Compare>
						<Lower>
							<Value1>DeviceDescr.Physics.Count</Value1>
							<Value2>3</Value2>
							<RaiseError Id="8">Invalid value or length of EtherCATInfo/Descriptions/Devices/Device/@Physics attribute.</RaiseError>
						</Lower>
					</Compare>
				</TestStep>
				<TestStep Name="Port2IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort2Connector">
					<Compare>
						<NotEqual>
							<Value1>DeviceDescr.Physics[2]</Value1>
							<Value2>"Y"</Value2>
							<RaiseError Id="9" Param0="DeviceDescr.Physics[2]">Invalid Physics value '{0}' for port 2. Expected: 'Y'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkEthercatPInfoPortCount</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port3IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkPhysicsLengthPort3">
					<Compare>
						<Lower>
							<Value1>DeviceDescr.Physics.Count</Value1>
							<Value2>4</Value2>
							<RaiseError Id="10">Invalid value or length of EtherCATInfo/Descriptions/Devices/Device/@Physics attribute.</RaiseError>
						</Lower>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3Connector">
					<Compare>
						<NotEqual>
							<Value1>DeviceDescr.Physics[3]</Value1>
							<Value2>"Y"</Value2>
							<RaiseError Id="11" Param0="DeviceDescr.Physics[3]">nvalid Physics value '{0}' for port 3. Expected: 'Y'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkEthercatPInfoPortCount">
					<Description Id="12">Check if at least one EtherCAT P port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<RaiseError Id="13">No EtherCAT P port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="14" Level="Success" Param0="ethercatpPortCount">{0} EtherCAT P port descriptions with correct Physics attribute values found</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Port Type" CaseId="4"><?MAX_OUTPUT_ID 10?>
				<Description>
					<Purpose>A EtherCAT P port shall be configured as 'MII' at the corresponding Type element </Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>-The test case iterates through the  EtherCAT P-ESI-Info/Port descriptions and compares the corresponding Port/Type</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test case succeeds if all EtherCAT P port descriptions are configured as MII type. Otherwise an error is thrown</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="3">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort1</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port0IncrementCount">
					<SetVariable Target="ethercatpPortCount">1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort0Connector">
					<Compare>
						<NotEqual>
							<Value1>Port0:Type</Value1>
							<Value2>"MII"</Value2>
							<RaiseError Id="4" Param0="Port0:Type">Invalid Port Type value '{0}' for port 0. Expected: 'MII'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port1IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort1Connector">
					<Compare>
						<NotEqual>
							<Value1>Port1:Type</Value1>
							<Value2>"MII"</Value2>
							<RaiseError Id="5" Param0="Port1:Type">Invalid Port Type value '{0}' for port 1. Expected: 'MII'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkInfoPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port2IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort2Connector">
					<Compare>
						<NotEqual>
							<Value1>Port2:Type</Value1>
							<Value2>"MII"</Value2>
							<RaiseError Id="6" Param0="Port2:Type">Invalid Port Type value '{0}' for port 2. Expected: 'MII'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkEthercatPInfoPortCount</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="Port3IncrementCount">
					<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
				</TestStep>
				<TestStep Name="checkInfoPort3Connector">
					<Compare>
						<NotEqual>
							<Value1>Port3:Type</Value1>
							<Value2>"MII"</Value2>
							<RaiseError Id="7" Param0="Port3:Type">Invalid Port Type value '{0}' for port 3. Expected: 'MII'</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkEthercatPInfoPortCount">
					<Description Id="8">Check if at least one EtherCAT P port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<RaiseError Id="9">No EtherCAT P port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="10" Level="Success" Param0="ethercatpPortCount">{0} EtherCAT P port descriptions with correct Port/Type values found</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="IN port PowerSupply" CaseId="5"><?MAX_OUTPUT_ID 7?>
				<Description>
					<Purpose>A EtherCAT P port0 shall not be configured as power supply</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>-The test case checks the PowerSupply elements of the EtherCAT P-Port0 descriptions</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test case succeeds if the PowerSupply elements of Port0 are not given or set to 'false'</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="3">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="4">Port0 is not configured as EtherCAT P</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0Connector">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckUp</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UsPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="5" Param0="Port0:EtherCATp:Us:PowerSupply">PowerSource element of Port0 Us '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUp">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="6" Param0="Port0:EtherCATp:Up:PowerSupply">PowerSource element of Port0 Up '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="7" Level="Success">PowerSupply element of Port0 is not set</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Min Voltage" CaseId="6"><?MAX_OUTPUT_ID 5?>
				<Description>
					<Purpose>The Device MinVoltage values shall not be greater than 20.4V</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The MinVoltage element must be available at /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/Device/Us/MinVoltage or at /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/Device/UP/MinVoltage </PreCondition>
					<Action>-The test case checks the MinVoltage elements of Device/Up and Device/Us</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test case succeeds the values are lower or equal 20.4V</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkIfUsMinVoltageIsAvailable">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Us:MinVoltage</Value1>
							<Value2>null</Value2>
							<GotoStep>checkIfUpMinVoltageIsAvailable</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkIfUsMinVoltage">
					<Compare>
						<Greater>
							<Value1>Electrical:EtherCATp:Device:Us:MinVoltage</Value1>
							<Value2>20.4</Value2>
							<RaiseError Id="3" Param0="Electrical:EtherCATp:Device:Us:MinVoltage">MinVoltage of Device/Us '{0}' exceeds 20.4V</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="checkIfUpMinVoltageIsAvailable">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Up:MinVoltage</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkIfUpMinVoltage">
					<Compare>
						<Greater>
							<Value1>Electrical:EtherCATp:Device:Up:MinVoltage</Value1>
							<Value2>20.4</Value2>
							<RaiseError Id="4" Param0="Electrical:EtherCATp:Device:Up:MinVoltage">MinVoltage of Device/Up '{0}' exceeds 20.4V</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="5" Level="Success">MinVoltage values correct or unused. </WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Max Current" CaseId="7"><?MAX_OUTPUT_ID 25?>
				<Description>
					<Purpose>Max current value shall be 3A for EtherCAT P OUT-ports</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp</PreCondition>
					<Action>The test case iterates through the ESI-Info/Port descriptions and checks the max current values</Action>
					<PostCondition>-The test case will be skipped for non EtherCAT P devices
-Test case succeeds if all max current values are defined as 3A. Otherwise an error is thrown.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Description Id="3">Check if at least one port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1Us">
					<Description Id="5">Check Us:MaxCurrent description of port 1</Description>
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort1Up</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="6" Param0="Port1:EtherCATp:Us:MaxCurrent">Invalid Port1-Us/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1Up">
					<Description Id="7">Check Up:MaxCurrent description of port 1</Description>
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort2Us</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="8" Param0="Port1:EtherCATp:Up:MaxCurrent">Invalid Port1-Up/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2Us">
					<Description Id="9">Check Us:MaxCurrent description of port 2</Description>
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort2Up</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="10" Param0="Port2:EtherCATp:Us:MaxCurrent">Invalid Port2-Us/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2Up">
					<Description Id="11">Check Up:MaxCurrent description of port 2</Description>
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort3Us</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="12" Param0="Port2:EtherCATp:Up:MaxCurrent">Invalid Port2-Up/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3Us">
					<Description Id="13">Check Us:MaxCurrent description of port 3</Description>
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort3Up</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="14" Param0="Port3:EtherCATp:Us:MaxCurrent">Invalid Port3-Us/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3Up">
					<Description Id="15">Check Up:MaxCurrent description of port 3</Description>
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckEthercatPInfoPortCount</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="16" Param0="Port3:EtherCATp:Up:MaxCurrent">Invalid Port3-Up/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckEthercatPInfoPortCount">
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<GotoStep>CheckPort0UsAsEndDevice</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0Us">
					<Description Id="17">Check Up:MaxCurrent description of port 0</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort0Up</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<NotEqual>
							<Value1>Port0:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="18" Param0="Port0:EtherCATp:Us:MaxCurrent">Invalid Port0-Us/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0Up">
					<Description Id="19">Check Up:MaxCurrent description of port 0</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="20" Param0="Port0:EtherCATp:Up:MaxCurrent">Invalid Port0-Up/MaxCurrent value '{0}A' of port 1 detected. 3A expected.</RaiseError>
						</Greater>
					</Compare>
					<Compare>
						<Equal>
							<Value1>true</Value1>
							<Value2>true</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UsAsEndDevice">
					<Description Id="21">Check Up:MaxCurrent description of port 0 as end device</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort0UpAsEndDevice</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Port0:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="22" Param0="Port0:EtherCATp:Us:MaxCurrent">Invalid Port0-Us/MaxCurrent value '{0}A' of port 1 detected. 3A or less expected.</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UpAsEndDevice">
					<Description Id="23">Check Up:MaxCurrent description of port 0 as end device</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="24" Param0="Port0:EtherCATp:Up:MaxCurrent">Invalid Port0-Up/MaxCurrent value '{0}A' of port 1 detected. 3A or less expected.</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="25" Level="Success">Max current values used as expected</WriteLine>
				</TestStep>
			</TestCase>
		</TestGroup>
		<TestGroup Name="ESI plausibility of Powered Devices(PD)" GroupId="2">
			<Comment>Checks the ESI plausibility of EtherCAT P powered devices</Comment>
			<TestCase Name="EtherCAT P OUT port PowerSupply(PD)" CaseId="1"><?MAX_OUTPUT_ID 11?>
				<Description>
					<Purpose>A EtherCAT P port1 to portn shall not be configured as power supply for EtherCAT P powered devices</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The PowerSupply element of the corresponding ESI-Device shall not be configured at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/PowerSupply	</PreCondition>
					<Action>-The test case checks the PowerSupply elements of the EtherCAT P-Port1 to Portn descriptions</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test will be skipped for EtherCAT P Power Sourcing devices
-The test case succeeds if all PowerSupply elements of the tested EtherCAT P port descriptions are not set. Otherwise an error is thrown.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is a 'Power Sourcing' or 'Power Renewing' device and not subject of this test case.</SkipCase>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1Connector">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckUpPort1</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1UsPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="5" Param0="Port1:EtherCATp:Us:PowerSupply">PowerSupply element of Port1 Us '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1UpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="6" Param0="Port1:EtherCATp:Up:PowerSupply">PowerSupply element of Port1 Up '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2Connector">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckUpPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2UsPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="7" Param0="Port2:EtherCATp:Us:PowerSupply">PowerSupply element of Port2 Us '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2UpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="8" Param0="Port2:EtherCATp:Up:PowerSupply">PowerSupply element of Port2 Up '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort3Connector">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckUpPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3UsPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="9" Param0="Port3:EtherCATp:Us:PowerSupply">PowerSupply element of Port3 Us '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3UpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="10" Param0="Port3:EtherCATp:Up:PowerSupply">PowerSupply element of Port3 Up '{0}' shall be false or not set.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="11" Level="Success">PowerSupply element of Port1 to Portn is not set</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="EtherCAT P Device Us/Up PowerSupply(PD)" CaseId="2"><?MAX_OUTPUT_ID 6?>
				<Description>
					<Purpose>EtherCAT P powered devices shall not define a Device:Us/Up:PowerSupply equals true.</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The PowerSupply element of the corresponding ESI-Device shall not be configured at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/PowerSupply	</PreCondition>
					<Action>-The test case checks the PowerSupply elements of the Device:Up and Device:Us</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test will be skipped for EtherCAT P Power Sourcing devices
-The test case succeeds if no PowerSupply elements are defined in Device:Us and Device:Up</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is a 'Power Sourcing' or 'Power Renewing' device and not subject of this test case.</SkipCase>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkDeviceUsPowerSupply">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>checkDeviceUpPowerSupply</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="4">Electrical:EtherCATp:Device:Us:PowerSupply shall not be defined for Powered Devices</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkDeviceUpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="5">Electrical:EtherCATp:Device:Up:PowerSupply shall not be defined for Powered Devices</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="6" Level="Success">PowerSupply element of Device:Up and Device:Us is used correctely</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Optional Device and Port Up Description" CaseId="3"><?MAX_OUTPUT_ID 13?>
				<Description>
					<Purpose>A EtherCAT P port 0 description may not contain the  optional Up element. This rule only applies to EtherCAT P end devices and EtherCAT P decoupler. Powered EtherCAT P devices with more than one EtherCAT P Ports shall provide the UP element for each EtherCAT P port. </Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The PowerSupply element of the corresponding ESI-Device shall not be configured at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/PowerSupply</PreCondition>
					<Action>-The test case checks the availibility of Up elements of the device and the EtherCAT P Ports</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test will be skipped for EtherCAT P Power Sourcing devices
-The test will be skipped if more than port 0 is defined as EtherCAT P
-The test case succeeds if all PowerSupply elements of the tested EtherCAT P port descriptions are not set. Otherwise an error is thrown.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is a 'Power Sourcing' or 'Power Renewing' device and not subject of this test case.</SkipCase>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkDeviceType">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp NOTEQUAL null AND Port1:EtherCATp EQUAL null AND Port2:EtherCATp EQUAL null AND Port3:EtherCATp EQUAL null</Value1>
							<Value2>true</Value2>
							<GotoStep>isEndOrDecoupler</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp NOTEQUAL null AND (Port1:EtherCATp NOTEQUAL null OR Port2:EtherCATp NOTEQUAL null OR Port3:EtherCATp NOTEQUAL null)</Value1>
							<Value2>true</Value2>
							<GotoStep>isPoweredDevice</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp </Value1>
							<Value2>null</Value2>
							<RaiseError Id="5">EtherCATp element of Port0 is not specified. This is not correct for a 'Powered Device'.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="isEndOrDecoupler">
					<Description Id="6">Check Powered device with one EtherCAT P port. (Port0)</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up NOTEQUAL null AND Electrical:EtherCATp:Device:Up NOTEQUAL null</Value1>
							<Value2>true</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up EQUAL null AND Electrical:EtherCATp:Device:Up EQUAL null</Value1>
							<Value2>true</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>true</Value1>
							<Value2>true</Value2>
							<RaiseError Id="7">End or Decoupler device detected. Up element of 'Port0:EtherCATp' does not match to the Up element of the 'Electrical:EtherCATp:Device' element</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="isPoweredDevice">
					<Description Id="8">Check Powered device with more than one EtherCAT P port</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up</Value1>
							<Value2>null</Value2>
							<RaiseError Id="9">Powered device detected. The Port0:EtherCATp:Up element is mandatory.</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp NOTEQUAL null Port1:EtherCATp:Up EQUAL null</Value1>
							<Value2>true</Value2>
							<RaiseError Id="10">Powered device detected. The Port1:EtherCATp:Up element is mandatory.</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp NOTEQUAL null Port2:EtherCATp:Up EQUAL null</Value1>
							<Value2>true</Value2>
							<RaiseError Id="11">Powered device detected. The Port2:EtherCATp:Up element is mandatory.</RaiseError>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp NOTEQUAL null Port3:EtherCATp:Up EQUAL null</Value1>
							<Value2>true</Value2>
							<RaiseError Id="12">Powered device detected. The Port3:EtherCATp:Up element is mandatory.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="13" Level="Success">The optional Up ESI elements are used as required</WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="Device Current" CaseId="4"><?MAX_OUTPUT_ID 14?>
				<Description>
					<Purpose>Device current value shall be less or equal 3A. The Device:Current shall be less than the Port0:MaxCurrent for end device types. </Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
- The Device:Us:Current element of the corresponding ESI-Device must be available at /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/Device/Us/Current</PreCondition>
					<Action>The test case checks the current value against the Port MaxCurrent value</Action>
					<PostCondition>-The test case will be skipped for non EtherCAT P devices
-Test case succeeds if the Device:Us/Up:Current Value is less than 3A and less than the Port0-MaxCurrent.
-The test will be skipped for EtherCAT P powered devices</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is a 'Power Sourcing Device' and not subject of this test case.</SkipCase>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Description Id="4">Check if at least one port description is available at the Device:Info element</Description>
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="5">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1Us">
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2Us">
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3Us">
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<SetVariable Target="ethercatpPortCount">ethercatpPortCount+1</SetVariable>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckEthercatPInfoPortCount">
					<Compare>
						<Equal>
							<Value1>ethercatpPortCount</Value1>
							<Value2>0</Value2>
							<GotoStep>CheckPort0UsAsEndDevice</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0Us">
					<Description Id="6">Check Device:Us:Current</Description>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Us:Current</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort0Up</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Electrical:EtherCATp:Device:Us:Current</Value1>
							<Value2>3</Value2>
							<RaiseError Id="7" Param0="Electrical:EtherCATp:Device:Us:Current">Invalid Device/Us/Current value '{0}A'of detected. A value less than 3A expected.</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0Up">
					<Description Id="8">Check Device:Up:Current</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>3</Value2>
							<RaiseError Id="9" Param0="Port0:EtherCATp:Up:MaxCurrent">Invalid Device/Us/Current value '{0}A'of detected. A value less than 3A expected.</RaiseError>
						</Greater>
					</Compare>
					<Compare>
						<Equal>
							<Value1>true</Value1>
							<Value2>true</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UsAsEndDevice">
					<Description Id="10">Check Device:Us:Current as end device</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Us:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort0UpAsEndDevice</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Us:Current</Value1>
							<Value2>null</Value2>
							<GotoStep>CheckPort0UpAsEndDevice</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Electrical:EtherCATp:Device:Us:Current</Value1>
							<Value2>Port0:EtherCATp:Us:MaxCurrent</Value2>
							<RaiseError Id="11" Param0="Electrical:EtherCATp:Device:Us:Current" Param1="Port0:EtherCATp:Us:MaxCurrent">Invalid Device/Us/Current value '{0}A'of detected. A value less than Port0/EtherCATp/Us/MaxCurrent '{1}A' expected.</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort0UpAsEndDevice">
					<Description Id="12">Check Device:Up:Current as end device</Description>
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp:Up:MaxCurrent</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:Device:Up:Current</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
					<Compare>
						<Greater>
							<Value1>Electrical:EtherCATp:Device:Up:Current</Value1>
							<Value2>Port0:EtherCATp:Up:MaxCurrent</Value2>
							<RaiseError Id="13" Param0="Electrical:EtherCATp:Device:Up:Current" Param1="Port0:EtherCATp:Up:MaxCurrent">Invalid Device/Up/Current value '{0}A'of detected. A value less than Port0/EtherCATp/Up/MaxCurrent '{1}A' expected.</RaiseError>
						</Greater>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="14" Level="Success">Max current values used as expected</WriteLine>
				</TestStep>
			</TestCase>
		</TestGroup>
		<TestGroup Name="ESI plausibility of Power Sourcing Devices(PS)" GroupId="3">
			<Comment>Checks the ESI plausibility of Power Sourcing devices</Comment>
			<TestCase Name="EtherCAT P OUT port PowerSupply(PS) " CaseId="1"><?MAX_OUTPUT_ID 17?>
				<Description>
					<Purpose>A EtherCAT P port1 to portn shall be configured as power supply for EtherCAT P powered devices</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The PowerSupply element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/PowerSupply	</PreCondition>
					<Action>-The test case checks the PowerSupply elements of the EtherCAT P-Port1 to Portn descriptions</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test will be skipped for EtherCAT P powered devices
-The test case succeeds if all PowerSupply elements of the tested EtherCAT P port descriptions are set. Otherwise an error is thrown.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is not a 'Power Sourcing' or 'Power Renewing' device and not subject of this test case.</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort2</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort1Connector">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="5">PowerSupply element of Port1 Us shall be set for power sourcing devices</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1UsPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="6" Param0="Port1:EtherCATp:Us:PowerSupply">PowerSupply element of Port1 Us '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort1">
					<Compare>
						<Equal>
							<Value1>Port1:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="7">PowerSupply element of Port1 Up shall be set for power sourcing devices</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort1UpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port1:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="8" Param0="Port1:EtherCATp:Up:PowerSupply">PowerSupply element of Port1 Up '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>checkPort3</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort2Connector">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="9">PowerSupply element of Port2 Us shall be set for power sourcing devices.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2UsPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="10" Param0="Port2:EtherCATp:Us:PowerSupply">PowerSupply element of Port2 Us '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort2">
					<Compare>
						<Equal>
							<Value1>Port2:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="11">PowerSupply element of Port2 Up shall set for power sourcing devices.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort2UpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port2:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="12" Param0="Port2:EtherCATp:Up:PowerSupply">PowerSupply element of Port2 Up '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp</Value1>
							<Value2>null</Value2>
							<GotoStep>WriteSuccess</GotoStep>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortConnector">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Us:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="13">PowerSupply element of Port3 Us shall be set for power sourcing devices.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3UsPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp:Us:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="14" Param0="Port3:EtherCATp:Us:PowerSupply">PowerSupply element of Port3 Us '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="CheckUpPort3">
					<Compare>
						<Equal>
							<Value1>Port3:EtherCATp:Up:PowerSupply</Value1>
							<Value2>null</Value2>
							<RaiseError Id="15">PowerSupply element of Port3 Up shall be set for power sourcing devices.</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="CheckPort3UpPowerSupply">
					<Compare>
						<NotEqual>
							<Value1>Port3:EtherCATp:Up:PowerSupply</Value1>
							<Value2>true</Value2>
							<RaiseError Id="16" Param0="Port3:EtherCATp:Up:PowerSupply">PowerSupply element of Port3 Up '{0}' shall be set for power sourcing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="17" Level="Success">PowerSupply elements of Port1 to Portn are configured correctly </WriteLine>
				</TestStep>
			</TestCase>
			<TestCase Name="EtherCAT P tolarance of IN port" CaseId="2"><?MAX_OUTPUT_ID 8?>
				<Description>
					<Purpose>The Port0 shall be "EtherCAT P tolerant" for Power Sourcing Devices with an EtherCAT P IN-port and at least one EtherCAT P OUT-port</Purpose>
					<PreCondition>-The EtherCAT P element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp
-The PowerSupply element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Electrical/EtherCATp/PowerSupply
-The EtherCATp element of the corresponding ESI-Device must be available at XPath /EtherCATInfo/Descriptions/Devices/Device[n]/Info/Port[1]/EtherCATp</PreCondition>
					<Action>-The test case checks that the Port0 is EtherCAT P tolerant. 'Tolarant' means there is no definition of Us or Up allowed for Port 0.</Action>
					<PostCondition>-The test will be skipped for non EtherCAT P devices
-The test will be skipped for EtherCAT P powered devices
-The test case succeeds if the EtherCATp element is empty.</PostCondition>
					<References>
						<Reference Specification="todo" Chapter="todo"></Reference>
					</References>
					<Mandatory>true</Mandatory>
				</Description>
				<TestStep Name="init">
					<Description Id="0">Check for EtherCAT P support</Description>
					<CallTestFunction Name="InitEsiValues"></CallTestFunction>
					<WriteLine Id="1" Level="Output">Device supports EtherCAT P</WriteLine>
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="2">EtherCAT P is not supported</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoElectricalEtherCATpPowerSupply">
					<Compare>
						<Equal>
							<Value1>Electrical:EtherCATp:PowerSupply</Value1>
							<Value2>null</Value2>
							<SkipCase Id="3">Device is not a 'Power Sourcing Device' and not subject of this test case.</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPortCount">
					<Compare>
						<Equal>
							<Value1>DeviceDescr.Info.Port.Count</Value1>
							<Value2>0</Value2>
							<RaiseError Id="4">No port descriptions found in ESI. EtherCAT P devices requiers at least one port description at //element(*,DeviceType)/Info/Port</RaiseError>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkPort0EtherCATp">
					<Compare>
						<Equal>
							<Value1>Port0:EtherCATp</Value1>
							<Value2>null</Value2>
							<SkipCase Id="5">Device is not an EtherCAT P Refreshing Device. EtherCATp element of port 0 is not defined,</SkipCase>
						</Equal>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0EtherCATpUs">
					<Compare>
						<NotEqual>
							<Value1>Port0:EtherCATp:Us</Value1>
							<Value2>null</Value2>
							<RaiseError Id="6">EtherCATp:Us-element of Port0 shall not be defined for EtherCAT P refreshing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="checkInfoPort0EtherCATpUp">
					<Compare>
						<NotEqual>
							<Value1>Port0:EtherCATp:Up</Value1>
							<Value2>null</Value2>
							<RaiseError Id="7">EtherCATp:Up-element of Port0 shall not be defined for EtherCAT P refreshing devices.</RaiseError>
						</NotEqual>
					</Compare>
				</TestStep>
				<TestStep Name="WriteSuccess">
					<WriteLine Id="8" Level="Success">Port0 is EtherCAT P tolerant. </WriteLine>
				</TestStep>
			</TestCase>
		</TestGroup>
	</TestGroups>
</EtherCATTest>